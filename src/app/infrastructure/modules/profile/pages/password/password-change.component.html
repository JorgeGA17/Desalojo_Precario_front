<!-- =========================================
     ADAPTADOR PRIMARIO (UI)
     - Formulario reactivo para cambiar contrase√±a
     - Usa PrimeNG
     ========================================= -->
<p-toast position="top-right"></p-toast>

<div class="page">
  <p-card header="Cambiar contrase√±a">
    <!-- ‚úÖ Contenido cargado -->
    <form [formGroup]="form" (ngSubmit)="onSubmit()" class="pwd-grid" novalidate>
      
      <!-- üîë Contrase√±a actual -->
      <label for="pwdCurrent">Contrase√±a actual</label>
      <div class="ctrl">
        <p-password
          inputId="pwdCurrent"
          formControlName="currentPassword"
          [toggleMask]="true"
          [feedback]="false"
          [ngClass]="{ 'p-invalid': showError('currentPassword') }">
        </p-password>
        <small class="help p-error" *ngIf="showError('currentPassword')">
          Requerida
        </small>
      </div>

      <!-- üÜï Nueva contrase√±a -->
      <label for="pwdNew">Nueva contrase√±a</label>
      <div class="ctrl">
        <p-password
          inputId="pwdNew"
          formControlName="newPassword"
          [toggleMask]="true"
          [feedback]="true"
          promptLabel="Escribe una contrase√±a"
          weakLabel="D√©bil"
          mediumLabel="Media"
          strongLabel="Fuerte"
          [ngClass]="{ 'p-invalid': showError('newPassword') }">
        </p-password>
        <small class="help p-error" *ngIf="showError('newPassword')">
          M√≠nimo 8 caracteres
        </small>
      </div>

      <!-- üîÅ Confirmar nueva -->
      <label for="pwdConfirm">Confirmar nueva</label>
      <div class="ctrl">
        <p-password
          inputId="pwdConfirm"
          formControlName="confirm"
          [toggleMask]="true"
          [feedback]="false"
          [ngClass]="{ 'p-invalid': form.hasError('passwordMismatch') && form.get('confirm')?.touched }">
        </p-password>
        <small class="help p-error" *ngIf="form.hasError('passwordMismatch') && form.get('confirm')?.touched">
          Las contrase√±as no coinciden
        </small>
      </div>

      <!-- üéØ Acci√≥n -->
      <div class="actions">
        <p-button 
        type="submit" 
        label="Actualizar contrase√±a" 
        styleClass="p-button-secondary"
        icon="pi pi-key">
      </p-button>
      </div>
    </form>
  </p-card>
</div>
